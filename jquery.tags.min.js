/*!
 * jQuery Tags plugin v1.0
 * http://github.com/aquilez/jquery-tags
 *
 * Copyright 2011, Santiago Dimattia
 * Released under the MIT license.
 * http://www.opensource.org/licenses/mit-license.php
 *
 */
(function(a){a.fn.tags=function(b){var d={separator:",",tagAdded:function(){},tagRemoved:function(){}};var c=a.extend(d,b);a(this).each(function(){var g=a(this);var f={textfield:g,taglist:{},init:function(){var h=this;var j=this.textfield;if(!j.is("input[type=text]")){return}j.wrap('<div class="tag-manager" />');j.before('<ul class="tag-list"></ul>');j.before('<input type="hidden" name="'+j.attr("name")+'" />');j.removeAttr("name");h.add_tag();j.parent().bind("click",function(){j.focus()});j.bind("blur",function(){h.add_tag()}).keydown(function(e){if(e.keyCode==13){e.preventDefault();h.add_tag()}})},updateHiddenField:function(){var e="";for(i in this.taglist){e+=c.separator+this.taglist[i]}this.textfield.parent().children("input[type=hidden]").val(e.substring(1))},add_tag:function(){var h=this;var j=this.textfield;if(j.val()==""){return}tags=j.val().split(c.separator);for(i in tags){tag=tags[i].replace(/^\s+|\s+$/g,"");if(h.taglist[tag.toLowerCase()]===undefined){j.parent().children("ul.tag-list").append('<li data-name="'+tag+'">'+tag+' <a class="tag-remove-link">X</a></li>');h.taglist[tag.toLowerCase()]=tag;j.parent().find("li[data-name="+tag+"] a").unbind().click(function(){tagname=a(this).parent().data("name").toString().toLowerCase();delete h.taglist[tagname];h.updateHiddenField();a(this).parent().remove();c.tagRemoved(tag,j)})}c.tagAdded(tag,j)}h.updateHiddenField();j.val("")}};f.init()})}})(jQuery);